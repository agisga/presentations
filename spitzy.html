<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

    <title>Solve differential equations in Ruby using spitzy - Alexej Gossmann</title>

		<meta name="description" content="Tulane University Department of Mathematics.">
		<meta name="author" content="Alexej Gossmann">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/simple.css" id="theme">
		<link rel="stylesheet" href="css/theme/simple-custom.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->

    <!-- MathJax interation, copied from http://cryptotoxin.github.io/coding/math-symbols-latex-and-markdown/ and others-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
      MathJax.Hub.Config({TeX: {Macros:{subscript:['_{#1}',1],superscript:['^{#1}',1]}}});
    </script> 
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
        <section data-markdown>
          <script type="text/template">
## Solve differential equations in Ruby with `spitzy`

### Alexej Gossmann
#### Final Project in Scientific Computing III
#### Tulane University
#### Department of Mathematics
### 2015/3/7
          </script>
        </section>

        <section>
          <section data-markdown>
            <script type="text/template">
## What/Who is spitzy?

![Spitzy](images/spitzy.jpg "spitzy.jpg")

Spitzy &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $\equiv$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*YZTIPS*

$\equiv$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***Y*our *Z*appy-*T*appy *I*nitial and boundary value *P*artial (and ordinary) differential equation *S*olver**
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## What is spitzy?

<https://github.com/agisga/spitzy.git>

A growing collection of numerical methods for differential equations, written in Ruby.
            </script>
          </section>
        </section>

        <section>
          <section data-markdown>
            <script type="text/template">
## Why Ruby?

To my knowledge, apart from an [interface with the DASPK Fortran library](https://rubygems.org/gems/rb-daspk/versions/0.0.7-x86-mswin32-60), there currently does not exist another differential equation solver gem for Ruby.
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Who is using Ruby?

![Ruby logo](images/ruby.png "ruby.png")

<https://www.ruby-lang.org/en/documentation/success-stories/>
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Who is using Ruby?

![Ruby on Rails logo](images/Ruby_on_Rails-logo.jpeg "Ruby_on_Rails-logo.png")

<http://thecoderfactory.com/posts/top-15-sites-built-with-ruby-on-rails>
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Who is using Ruby?

![SciRuby logo](images/sciruby_logo.png "sciruby_logo.png")

<http://sciruby.com/>
            </script>
          </section>
        </section>

        <section>
          <section data-markdown>
            <script type="text/template">
##Initial Value Problems

* ODE: $\frac{dy}{dx} = f(x,y)$ for $a \leq x \leq b$,
* with initial condition $y(a) = y_0$.
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
For this kind of differential equation [spitzy](https://github.com/agisga/spitzy.git) provides the class `Ode`, which currently has three methods: 

* [Dormand-Prince](http://en.wikipedia.org/wiki/Dormand%E2%80%93Prince_method) 
* [Forward Euler](http://en.wikipedia.org/wiki/Euler_method) 
* [Adams-Bashforth](http://en.wikipedia.org/wiki/Linear_multistep_method) method of order 2.
            </script>
          </section>
				</section>

        <section>
          <section data-markdown>
            <script type="text/template">
## Dormand-Prince

* Forth-order and fifth-order Runge-Kutta, which use the same function evaluations.

* (Recall, Runge-Kutta: $u\subscript{n+1} = u\subscript{n} + h \sum\subscript{1}^s b\subscript{i}K\subscript{i}$.)

* Seven stages, but only six function evaluations.

* Automatic step size correction, based on the [local truncation error](http://en.wikipedia.org/wiki/Truncation_error_%28numerical_integration%29#Local_truncation_error) estimation of the forth-order scheme.

* Currently the default in MATLAB's `ode45`.
            </script>
          </section>


          <section data-markdown>
            <script type="text/template">
## Dormand-Prince Example

* ODE: $\frac{dy}{dx} = -2y + e^{-2(x-6)^2}$, $0 \leq x \leq 10$,
* IC: $y(0) = 1$.

```Ruby
f = proc { |t,y| -2.0 * y + Math::exp(-2.0 * (t - 6.0)**2) }
dopri_sol = Ode.new(xrange: [0.0,10.0], dx: 1.5, yini: 1.0, 
            tol: 1e-6, maxiter: 1e6, &f) 
```
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Dormand-Prince Example

![Dormand-Prince example plot](images/dopri2.png?raw=true "Dormand-Prince example plot")
            </script>
          </section>
        </section>

        <section>
          <section data-markdown>
            <script type="text/template">
##Forward Euler

* First-order Runge-Kutta method.

* $u\subscript{n+1} = u\subscript{n} + h f(x\subscript{n}, u\subscript{n}).$

* It is the most basic explicit method and often serves as a basis to construct more complex methods.
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Forward Euler Example

* ODE: $\frac{dy}{dx} = 1 + \frac{y}{x} + \left(\frac{y}{x}\right)^2$, $1 \leq x \leq 4$,
* IC: $y(1) = 0$.

```Ruby
f = proc { |t,y| 1.0 + y/t + (y/t)**2 }
euler_sol = Ode.new(xrange: [1.0,4.0], dx: 0.01,
                    yini: 0.0, method: :euler, &f) 
```
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Forward Euler Example
![Euler method example plot](images/euler_plot.png?raw=true "Euler method example plot")
            </script>
          </section>
        </section>

        <section>
          <section data-markdown>
            <script type="text/template">
## Second-Order Adams-Bashforth

* A second order method from the family of multi-step methods. 

* $u\subscript{n+1} = u\subscript{n} + \frac{h}{2}(3f(x\subscript{n},u\subscript{n}) - f(x\subscript{n-1},u\subscript{n-1}))$.

* Derived from $\frac{y\subscript{n+1} - y\subscript{n}}{h} = b\subscript{0} f(x\subscript{n},y\subscript{n}) + b\subscript{1} f(x\subscript{n-1},y\subscript{n-1})$.
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Second-Order Adams-Bashforth Example

* ODE: $\frac{dy}{dx} = -2xy$, $0 \leq x \leq 4$,
* IC: $y(0) = 1$.

```Ruby
require 'spitzy'

f = proc { |t,y| -2.0*t*y }
ab2_sol = Ode.new(xrange: [0.0,4.0], dx: 0.1, 
                  yini: 1.0, method: :ab2, &f) 

exact_sol = ab2_sol1.x.map { |tt| Math::exp(-(tt**2)) }
```
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
## Second-Order Adams-Bashforth Example

![Adams-Bashforth example plot](images/ab2_plot.png?raw=true "Adams-Bashforth example plot")
            </script>
          </section>
        </section>


      <section>
        <section data-markdown>
          <script type="text/template">
##Two-point Boundary Value Problem

* ODE: $-(\alpha u')'(x) + (\beta u')(x) + (\gamma u)(x) = f(x)$, for $a < x < b$,
* where $\alpha$, $\beta$ and $\gamma$ are constants or continuous functions of $x$ on $[a,b]$,
* with Dirichlet boundary conditions: $u(a) = u\subscript{a}$ and $u(b) = u\subscript{b}$.
          </script>
        </section>


        <section data-markdown>
          <script type="text/template">
###Weak Solution of a Two-point Boundary Value Problem

$$\underset{[a,b]}{\int} \alpha u' v' dx + \underset{[a,b]}{\int} \beta u' v dx + \underset{[a,b]}{\int} \gamma u v dx = \underset{[a,b]}{\int} f v dx,$$
for every $v$ in the [test-function space](http://en.wikipedia.org/wiki/Distribution_%28mathematics%29#Test_functions_and_distributions) $V$, which basically contains functions that have square-integrable [distributional derivatives](http://en.wikipedia.org/wiki/Distribution_%28mathematics%29#Derivatives_of_distributions) and vanish on the boundary of the domain of the ODE.
          </script>
        </section>
      </section>

      <section>
        <section data-markdown>
          <script type="text/template">
### Galerkin Method

* Approximate $V$ with a finite dimensional functional space $V\subscript{h}$.

* Assume that $u$ and $v$ are in $V\subscript{h}$.

* Then the problem reduces to a linear system
$$A\vec{u} = \vec{f}.$$

* The structure of $A$ and the degree of accuracy of the numerical solution depend on the form of the basis functions $\phi\subscript{1}, \phi\subscript{2}, \ldots, \phi\subscript{N}$, that is, on the choice of $V\subscript{h}$.
          </script>
        </section>

        <section data-markdown>
          <script type="text/template">
### Finite Element Method

* Choose $V_h$ to be the space of continuous piecewise polynomials which are defined on subintervals of $[a, b]$ and vanish at $a$ and $b$.

* Here, we only consider polynomials of degree 1, that is, continuous piecewise linear functions.

![Piecewise linear basis functions](images/fin_elt_basis_func_small.png?raw=true "Piecewise linear basis functions")

<cite>Wikipedia. <a href="http://en.wikipedia.org/wiki/Finite_element_method">http://en.wikipedia.org/wiki/Finite_element_method</a></cite>
          </script>
        </section>

        <section data-markdown>
          <script type="text/template">
### Linear Finite Element Galerkin Example

* ODE: $-\frac{d}{dx}(-\cos(x)u'(x)) + \sin(x)u'(x) + \cos(x) u(x) = -2\cos^2(x)$, $0 < x < 10$,

* BC: $u(0) = 0$, $u(10) = -9\sin(10)$.

* Exact solution: $u(x) = (1-x)\sin(x)$.

```Ruby
a = Proc.new { |x| -Math::cos(x) }
b = Proc.new { |x| Math::sin(x) }
c = Proc.new { |x| Math::cos(x) }
f = Proc.new { |x| -2.0*(Math::cos(x))**2 }
xrange = [0.0, 10.0]
bc = [0.0, (1.0 - 10.0) * Math::sin(10.0)]
bvp_sol = Bvp.new(xrange: xrange, mx: 100, bc: bc, 
                  a: a, b: b, c: c, f: f)
```
          </script>
        </section>

        <section data-markdown>
          <script type="text/template">
### Linear Finite Element Galerkin Example

![BVP example 2 plot](images/bvp2.png?raw=true "BVP example 2 plot")
          </script>
        </section>
      </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>

        <section data-markdown>
          <script type="text/template">

          </script>
        </section>


        <section data-markdown>
          <script type="text/template">

          </script>
        </section>


			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
